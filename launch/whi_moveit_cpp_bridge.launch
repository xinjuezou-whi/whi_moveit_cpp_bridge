<?xml version="1.0"?>
<launch>
  <!-- argument -->
  <arg name="arm" default="chin"/>
  <arg name="arm_model" default="crb7"/>
  <arg name="controller" default="fake"/>
  <arg name="combined" default="false"/>
  <arg name="fixed_frame" default="world"/>
  <arg name="with_rviz" default="true"/>

  <!-- params -->
  <rosparam file="$(find whi_moveit_cpp_bridge)/config/config_$(arg arm)_$(arg arm_model).yaml" command="load" subst_value="true"/>
  <!-- Specify the config files to use -->
  <rosparam ns="whi_moveit_cpp_bridge" command="load" file="$(find whi_moveit_cpp_bridge)/config/moveit_cpp.yaml"/>

  <!-- send fake joint values -->
  <group if="$(eval arg('controller') == 'fake')">
    <node name="robot_state_publisher" pkg="robot_state_publisher" type="robot_state_publisher"/>
    <node name="joint_state_publisher" pkg="joint_state_publisher" type="joint_state_publisher">
      <rosparam param="source_list">["/whi_moveit_cpp_bridge/fake_controller_joint_states"]</rosparam>
    </node>
  </group>

  <!-- arm launcher -->
  <group if="$(eval arg('combined') == true)">
    <include file="$(dirname)/$(arg arm)_combined_bringup.launch">
      <arg name="arm" value="$(arg arm)"/>
      <arg name="arm_model" value="$(arg arm_model)"/>
      <arg name="controller" value="$(arg controller)"/>
      <arg name="fixed_frame" value="$(arg fixed_frame)"/>
      <arg name="with_rviz" value="$(arg with_rviz)"/>
    </include>
  </group>
  <group unless="$(eval arg('combined') == true)">
    <include file="$(dirname)/$(arg arm)_bringup.launch">
      <arg name="arm" value="$(arg arm)"/>
      <arg name="arm_model" value="$(arg arm_model)"/>
      <arg name="controller" value="$(arg controller)"/>
      <arg name="fixed_frame" value="$(arg fixed_frame)"/>
      <arg name="with_rviz" value="$(arg with_rviz)"/>
    </include>
  </group>

  <!-- hardware interface -->
  <node name="whi_moveit_cpp_bridge" pkg="whi_moveit_cpp_bridge" type="whi_moveit_cpp_bridge_node" output="screen"/>
</launch>
